<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Random Text Chat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 15px;
    }
    #chatBox {
      border: 1px solid #ccc;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      margin-top: 10px;
    }
    .you { color: green; }
    .stranger { color: blue; }
  </style>
</head>
<body>

<h2>Random Text Chat</h2>

<label>Your Gender:</label>
<select id="gender">
  <option value="male">Male</option>
  <option value="female">Female</option>
</select>

<br><br>

<label>Chat With:</label>
<select id="want">
  <option value="any">Anyone</option>
  <option value="male">Male</option>
  <option value="female">Female</option>
</select>

<br><br>

<button onclick="startChat()">Start Chat</button>

<div id="chatBox"></div>

<br>

<input id="message" placeholder="Type message">
<button onclick="sendMessage()">Send</button>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const chatBox = document.getElementById("chatBox");

  function addMsg(text, cls) {
    const p = document.createElement("p");
    p.className = cls;
    p.innerText = text;
    chatBox.appendChild(p);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  function startChat() {
    socket.emit("start", {
      gender: gender.value,
      want: want.value
    });
    addMsg("Connected to stranger", "");
  }

  function sendMessage() {
    const msg = message.value;
    if (!msg) return;
    socket.emit("msg", msg);
    addMsg("You: " + msg, "you");
    message.value = "";
  }

  socket.on("msg", msg => {
    addMsg("Stranger: " + msg, "stranger");
  });
</script>

</body>
</html>
